---
layout: single
title: "[항해+] 사전 스터디 - TDD를 고민하면서 프로젝트 시작"
categories: 
 - Etc
date: 2024-12-12 10:06:30:00 +0900
---

## 1. 들어가기

TDD가 무엇인지 앞선 포스트를 작성하면서 알게 되었다. 이제 직접 TDD 방식으로 작업을 진행하면서, 왜 필요한지, 이 과정을 통해 개선되는 부분이 무엇인지, 불편한 점은 무엇인지, 이를 개선하기 위해 해야 할 것은 무엇인지, 그리고 내가 TDD에 대해 더 알아야 할 점은 무엇인지 등을 스스로 탐구하는 것이 중요하다.

본격적으로 TDD 방식으로 구현을 경험하기에 앞서, 내가 겪은 고민을 이야기 해보려 한다.

---

## 2. 내가 느낀 테스트 코드의 중요성

나는 Java/Spring 기반의 개발을 하고 있지만, TDD는커녕 테스트 코드를 작성해 본 적이 없다. 회사에서 테스트 코드를 작성하지 않는 개발 문화를 가지고 있다 보니, 테스트 코드의 중요성을 깊이 고민할 기회가 없었다.

그러다 보니, 내가 느끼는 문제점은 아래와 같다.

1. 테스트가 복잡하고 오래 걸린다.

회사에서 개발한 애플리케이션은 프론트엔드와 백엔드가 분리되지 않았다. 즉, 프론트엔드와 백엔드가 서로 종속적인 구조로 되어 있어서 테스트가 필요할 경우, 화면부터 DB 데이터까지 모두 확인하는 엔드 투 엔드(end-to-end) 테스트를 진행해야 했다.

예를 들어, 톰캣 서버를 실행하고, 화면 도구를 열어 테스트하려는 화면에 접근한 후, 테스트를 위한 조건을 설정해 테스트를 진행했다. 단위 테스트(Unit Test)조차도 이런 복잡한 과정을 거쳐야 했고, 이는 불필요한 소모로 이어졌다.

TDD 방식으로 작업한다면, 테스트 코드를 먼저 작성하고 이를 충족하기 위한 코드를 작성한 후 테스트를 실행하는 주기로 진행하므로 이러한 과정을 단순화할 수 있다.

2. 테스트 동작 상태를 유지하기 어렵다.

테스트 코드를 작성하지 않고, 개발자가 수동으로 테스트를 수행하면, 동일한 테스트 조건과 결과를 유지하기 어렵다. 테스트가 많아질수록 피로감은 더욱 커질 수밖에 없다. 반면, 작성된 테스트 코드를 이용하면 항상 동일한 테스트 조건을 보장받을 수 있고, 많은 양의 테스트를 클릭 한 번으로 수행할 수 있다.

이는 TDD 방식과 잘 맞는다. TDD는 테스트를 먼저 작성하고, 이 테스트를 충족하기 위해 코드를 작성하며, 이를 지속적으로 리팩토링해 나가는 개발 방식이다. 테스트 코드가 없었다면 동일한 결과를 보장받기 어려웠을 리팩토링 과정에서도, TDD는 테스트 코드로 안정성을 유지하며 작업할 수 있다.

3. 예외 처리의 커버리지가 부족하다.

수동으로 테스트를 수행하면, 테스트 시나리오나 케이스를 미처 고려하지 못할 때가 있다. 이로 인해 로직의 결함이 발생할 수 있다. JUnit 같은 도구를 사용하면, 미리 작성된 테스트 코드를 실행하는 것만으로도 정의된 테스트 케이스를 놓치지 않고 실행할 수 있다.

하지만 TDD에서도 테스트 커버리지가 부족한 경우는 발생할 수 있다. 따라서 테스트 설계 단계에서 가능한 모든 케이스와 예외를 충분히 고려하는 노력이 필요하다. 이는 도구의 한계가 아니라 테스트 설계의 문제라는 점을 인지해야 한다.

4. 아주 작은 단위 테스트가 어렵다.

만약 특정 데이터를 조회하는 기능만 테스트하고 싶다면, 기존 방식으로는 어렵다. 화면에서 요청을 받아야 하기 때문에, 컨트롤러와 서비스 등 모든 레이어를 거칠 수밖에 없기 때문이다. 하지만 JUnit을 이용하면, 예를 들어 Repository 레이어만 별도로 테스트할 수 있다.

또한, 아직 컨트롤러만 작성된 상태에서 단위 테스트를 진행하고 싶다면, Mock이나 Stub 같은 도구를 사용해 하위 레이어의 의존성을 대체하고 테스트할 수 있다. 예를 들어, DB가 준비되지 않은 상황에서도 Mock API를 이용해 프론트엔드 개발자에게 API 명세를 전달하거나 테스트 환경을 만들어줄 수 있다. 이는 TDD의 테스트 주도 접근법과 잘 맞는다. 다만, Mock과 Stub을 과도하게 사용하면 테스트 복잡성을 높일 수 있으므로, 필요한 경우에만 적절히 사용해야 한다.

5. CI/CD 과정에서 품질을 유지할 수 있다.

코드는 항상 오류 없이 동작하기를 바란다. 소스 코드를 통합하거나 배포하는 과정에서도 마찬가지다. TDD로 작성된 테스트 코드는 CI/CD 파이프라인에서 자동으로 실행되며, 오류 없는 소스가 배포되도록 보장한다.

다만, CI/CD의 품질은 테스트 코드뿐만 아니라 빌드 환경, 배포 환경, 설정 관리 등 여러 요소가 함께 작동해야만 유지된다는 점도 중요하다. 테스트 코드는 CI/CD의 품질을 보장하기 위한 중요한 단계 중 하나일 뿐이다.
마무리하며

TDD는 단순히 테스트를 자동화하는 도구적 접근법이 아니라, 개발의 흐름을 바꾸는 패러다임이다. TDD를 적용함으로써 단위 테스트가 복잡하고 오래 걸리는 문제를 해결하고, 테스트의 신뢰성을 높이며, 리팩토링 과정에서도 안정성을 유지할 수 있었다. 아직 부족한 점도 있고 익숙하지 않은 부분도 많지만, TDD 방식의 개발을 통해 점차 개선될 수 있을 것이라 생각한다.

---

## 3. TDD를 고려한 프로젝트 진행 방식 고민

내가 생각하였던 전반적인 개발 과정은 아래와 같다.

```json
스프린트 1 -> 기본 분석 및 설계, 간단한 구현
주요 목적은 테스트 정의와 프론트와의 빠른 협업을 위한 MockAPI구현입니다.

	1.	요구사항 분석 및 유스케이스 도출
	2.	간단한 도메인 설계 (예: User 엔티티)
	3.	단위 테스트 작성 (Red 단계)
	4.	Green 단계 통과 (기본 로직 구현)
	5.	Mock API 작성 (프론트 협업 또는 테스트용)
	6.	API 명세(Swagger 등) 제공

스프린트 2 -> 테스트 보완, 설계 및 리팩토링
주요 목적은 테스트, 설계, 구현의 개선입니다. 필요상 아키텍쳐 개선도 포함 될 수 있습니다.

	1.	테스트 케이스 추가 (엣지 케이스, 경계값 등)
	2.	도메인 설계 보완 (새로운 엔티티 추가 또는 관계 정의)
	3.	ERD 설계 및 확장
	4.	코드 리팩토링 (클린 코드, 의존성 관리 개선)

스프린트 3 이후 점진적 기능 추가와 개선
주요 목적은 피드백 분석 및 개선과정입니다.

	1. 각 스프린트에서 새로운 기능을 도입하거나 기존 로직을 개선합니다.
	2. 점진적으로 복잡한 요구사항을 해결하며, 도메인 및 테스트 설계를 계속 확장합니다.

이후 반복...
```

### 주제

나는 “대용량 트래픽을 고려한 콘서트 예매”라는 주제로 작은 토이 프로젝트를 진행하려고 한다. 

다음 포스팅 부터는 내가 개발하면서 고민했던 과정을 남기려고 한다.

